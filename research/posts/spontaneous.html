<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Carsen Stringer*, Marius Pachitariu*, Nicholas Steinmetz, Charu Bai Reddy, Matteo Carandini†, Kenneth D Harris†">
<meta name="description" content="Ongoing neural activity is high-dimensional and driven by the mouse’s behavior. These behavioral representations are orthogonal to stimulus-driven responses.">

<title> - Spontaneous behaviors drive multidimensional, brainwide activity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"><img src="../../images/logo.png" width="60px"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../people/index.html" rel="" target="">
 <span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../research/publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../code_and_data.html" rel="" target="">
 <span class="menu-text">Code &amp; data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../positions.html" rel="" target="">
 <span class="menu-text">Positions</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Spontaneous behaviors drive multidimensional, brainwide activity</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Thousands of neurons</div>
    <div class="quarto-category">Behavior</div>
    <div class="quarto-category">Machine learning</div>
  </div>
  </div>

<div>
  <div class="description">
    <p>Ongoing neural activity is high-dimensional and driven by the mouse’s behavior. These behavioral representations are orthogonal to stimulus-driven responses.</p>
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Carsen Stringer*, Marius Pachitariu*, Nicholas Steinmetz, Charu Bai Reddy, Matteo Carandini<sup>†</sup>, Kenneth D Harris<sup>†</sup> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 2019</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<details>
<summary>
<p style="font-size: smaller">
Abstract
</p>
</summary>
<p style="font-size: smaller">
Neuronal populations in sensory cortex produce variable responses to sensory stimuli and exhibit intricate spontaneous activity even without external sensory input. Cortical variability and spontaneous activity have been variously proposed to represent random noise, recall of prior experience, or encoding of ongoing behavioral and cognitive variables. Recording more than 10,000 neurons in mouse visual cortex, we observed that spontaneous activity reliably encoded a high-dimensional latent state, which was partially related to the mouse’s ongoing behavior and was represented not just in visual cortex but also across the forebrain. Sensory inputs did not interrupt this ongoing signal but added onto it a representation of external stimuli in orthogonal dimensions. Thus, visual cortical population activity, despite its apparently noisy structure, reliably encodes an orthogonal fusion of sensory and multidimensional behavioral information.
</p>
</details>
<a href="https://pubmed.ncbi.nlm.nih.gov/31000656/">paper</a> | <a href="https://youtu.be/1FCCh4COiCM?feature=shared&amp;t=196">talk</a> | <a href="https://www.quantamagazine.org/noise-in-the-brains-vision-areas-encodes-body-movements-20191107/">Quanta news article</a> | <a href="https://www.simonsfoundation.org/2019/11/26/thinking-on-the-go-why-does-the-whole-brain-light-up-for-just-the-smallest-movements/">Simons news article</a> | <a href="https://www.biorxiv.org/content/10.1101/306019v2">preprint</a> | <a href="https://figshare.com/articles/dataset/Recordings_of_ten_thousand_neurons_in_visual_cortex_during_spontaneous_behaviors/6163622">data</a> | <a href="https://github.com/MouseLand/stringer-pachitariu-et-al-2018a">code</a> | <a href="https://twitter.com/marius10p/status/988069221941874688?s=20&amp;t=yo99GGoVUvVipW_3v7ce1g">original tweeprint</a>
<hr>
<center>
<img src="images/spont_cover.jpeg" width="80%">
</center>
<p>Thread:</p>
<ol type="1">
<li>Neurons in the brain are very chatty: they fire action potentials, their basic unit of communication, even when there is nothing to communicate. For example in this video, in visual cortex recordings in complete darkness. Lots of chatting:
<p></p>
<p>
<video src="https://www.suite2p.org/static/images/raw12planes.mp4" width="90%" loop="true" autoplay="autoplay" controls="" muted="">
</video>
</p></li>
<li>The puzzle is that these neurons are in visual cortex, so they should only be talking about what the eyes tell them. But here they are in pitch black darkness, chatting continuously.
<p></p></li>
<li>This has been known for a long time, ever since the first recordings of single neurons in live brains.
<p></p></li>
<li>Neuroscientists are divided. Some think the chattering is just noise. Others think the neurons are chatting about something very important, we just can’t understand their language.
<p></p></li>
<li>Recording one neuron at a time, we have no chance to understand this language. It’s like hearing only half of a conversation:
<p></p>
<p>
Neuron B: “You’re just paranoid.”<br> Neuron B: “He started it.”
</p>
<p>
But really more like only a millionth of it:
</p>
<p>
Neuron B: “t”
</p></li>
<li>The number of recorded neurons has improved dramatically. We can now pick up whole conversations:
<p></p>
<p>
Neuron A: I think I saw something.<br> Neuron B: You’re just paranoid.<br> Neuron C: Shh, I’m trying to sleep here.<br> Neuron B: He started it.<br> Neuron D: I think we’re going to be eaten.
</p></li>
<li>We recorded about 10,000 neurons and sorted their activity using an algorithm so you can see next to each other groups of neurons that talk about the same things:
<p></p>
<p>
<img src="images/spont1.jpg" width="90%">
</p></li>
<li>This showed us there were many conversations going on at the same time. But we still didn’t know what the conversations were about.
<p></p></li>
<li>And for quite a while, we were clueless…
<p></p></li>
<li>But then it hit us. It was movements! The neurons were talking about movements!
<p></p></li>
<li>The neurons were following in real time the motor actions of the mouse, each of them chatting about a different type of movement!
<p></p></li>
<li>In mice, these motor actions are things like running, whisking, grooming and sniffing:
<p></p>
<p>
<video src="https://www.suite2p.org/static/images/face.mp4" width="90%" loop="true" autoplay="autoplay" controls="" muted="">
</video>
</p></li>
<li>We detected these motor actions from the videos using automated algorithms:
<p></p>
<img src="images/spont2.jpg" width="100%">
<p></p></li>
<li>And then used all this motor information to predict which neurons were chatting and when:
<p></p>
<p>
<img src="images/spont3.jpg" width="100%">
</p></li>
<li>We predicted a lot, about 50% of the neural conversation. In fact, in every area of the brain we looked, we could predict about that much:
<p></p>
<p>
<img src="images/spont4.jpg" width="100%">
</p></li>
<li>To conclude, neurons in mice, and probably in your brain, are always chatting about what you’re doing, even if these neurons normally respond to images or sounds or tickling.
<p></p></li>
<li>Why are they having this conversation about motor actions? It’s a bit of a mystery. Our theory is that it helps the brain detect coincidences: when action X and stimulus Y happen at the same time.
<p></p></li>
<li>Action X + stimulus Y could often lead to a consequence Z. Z can be a juicy reward, or a dangerous situation.
<p></p></li>
<li>Luckily, there is a neuron in your brain somewhere who noticed the coincidence XY, so it can alert everyone about the possible consequence Z before it happens!
<p></p></li>
<li>There are more esoteric interpretations, like the chattering being the mechanistic substrate of consciousness. We’ll leave this for others to ponder.
<p></p></li>
<li>We shared the data, and the code to run the analyses. <br>data: <a href="https://figshare.com/articles/dataset/Recordings_of_ten_thousand_neurons_in_visual_cortex_during_spontaneous_behaviors/6163622">(figshare)</a> <br>code: <a href="https://github.com/MouseLand/stringer-pachitariu-et-al-2018a">(github.com/MouseLand/stringer-pachitariu-et-al-2018a)</a>
<p></p>
<br><br></li>
</ol>
<p>P.S. We followed up on this story <a href="../../research/posts/facemap.html">here</a>!</p>



<center>
<img src="../../images/HHMI_Janelia_Logo-Black.png" width="120px" alt="Janelia"><br> <font size="2pt"> Powered by <a href="https://www.quarto.org">Quarto</a>. © Marius Pachitariu &amp; Carsen Stringer lab, 2023.</font>
</center></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>